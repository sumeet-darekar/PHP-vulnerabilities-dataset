PHP_Code,is_vulnerable,Description
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_select-interpretation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from_where-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__join-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_select-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_AS-interpretation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__join-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_select-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from_where-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__join-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__join-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from_where-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_select-concatenation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from_where-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from_where-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_select-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_AS-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_select-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from_where-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from_where-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from_where-concatenation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from_where-concatenation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_select-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_select-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_select-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from_where-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from_where-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from_where-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_AS-concatenation
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_AS-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from_where-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_AS-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_AS-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_AS-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_AS-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from_where-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__join-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_select-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_select-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from_where-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from_where-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__join-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from_where-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_AS-interpretation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__multiple_select-interpretation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_AS-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from_where-interpretation
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_AS-concatenation
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from_where-interpretation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_preg_match-no_filtering__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM student where id=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_select-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from_where-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__join-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_select-interpretation
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__join-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__multiple_select-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_FILTER-VALIDATION-email_filter__join-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = sprintf(""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_AS-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__select_from_where-concatenation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = system('ls', $retval);
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_mysql_real_escape_string__multiple_select-concatenation
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-VALIDATION-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__select_from_where-interpretation
"<?php
$tainted = $_SESSION['UserData'];
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__select_from-sprintf_%s_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
//no_sanitizing
$query = ""SELECT * FROM student where id="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__no_sanitizing__select_from_where-concatenation
"<?php
$tainted = $_SESSION['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_AS-concatenation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_FILTER-CLEANING-email_filter__join-sprintf_%s_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-special_chars_filter__select_from-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-special_chars_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-CLEANING-full_special_chars_filter__join-sprintf_%s_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-full_special_chars_filter__select_from-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__multiple_select-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from_where-interpretation
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__join-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_select-interpretation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent=' $tainted ')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_select-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-VALIDATION-email_filter__join-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-special_chars_filter__join-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__join-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__func_FILTER-CLEANING-full_special_chars_filter__join-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor="". $tainted . """";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__proc_open__func_mysql_real_escape_string__multiple_AS-concatenation
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_FILTER-CLEANING-special_chars_filter__select_from-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_select-concatenation
"<?php
$tainted = $_POST['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__join-sprintf_%s_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_mysql_real_escape_string__multiple_AS-interpretation
"<?php
$tainted = $_GET['UserData'];
$tainted = mysql_real_escape_string($tainted);
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_mysql_real_escape_string__multiple_select-interpretation
"<?php
$tainted = $_GET['UserData'];
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__GET__func_FILTER-CLEANING-email_filter__select_from-concatenation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__backticks__func_FILTER-CLEANING-email_filter__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = sprintf(""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__func_preg_match-no_filtering__join-sprintf_%s_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__func_FILTER-VALIDATION-email_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent="". $tainted . "")"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__multiple_select-concatenation
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$sanitized = filter_var($tainted, FILTER_SANITIZE_EMAIL);
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__unserialize__func_FILTER-CLEANING-email_filter__join-concatenation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__multiple_AS-concatenation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-classicGet__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='"". $tainted . ""')"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_select-concatenation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__popen__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
//no_sanitizing
$query = ""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent= $tainted )"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__array-GET__no_sanitizing__multiple_select-interpretation
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__shell_exec__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT Trim(a.FirstName) & ' ' & Trim(a.LastName) AS employee_name, a.city, a.street & (' ' +a.housenum) AS address FROM Employees AS a WHERE a.supervisor=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__multiple_AS-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT lastname, firstname FROM drivers, vehicles WHERE drivers.id = vehicles.ownerid AND vehicles.tag=' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__join-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__fopen__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
$tainted = system('ls', $retval);
//no_sanitizing
$query = sprintf(""SELECT * FROM COURSE c WHERE c.id IN (SELECT idcourse FROM REGISTRATION WHERE idstudent='%s')"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__system__no_sanitizing__multiple_select-sprintf_%s_simple_quote
"<?php
$tainted = $_POST['UserData'];
//no_sanitizing
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__POST__no_sanitizing__select_from-concatenation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
if (filter_var($sanitized, FILTER_VALIDATE_EMAIL))
 $tainted = $sanitized ;
else
 $tainted = """" ;
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__SESSION__func_FILTER-VALIDATION-email_filter__select_from-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = ""SELECT * FROM student where id='"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__no_sanitizing__select_from_where-concatenation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$re = ""/^.*$/"";
if(preg_match($re, $tainted) == 1){
 $tainted = $tainted;
}
else{
 $tainted = """";
}
$query = ""SELECT * FROM ' $tainted '"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__func_preg_match-no_filtering__select_from-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM '%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-directGet__no_sanitizing__select_from-sprintf_%s_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$sanitized = filter_var($tainted, FILTER_SANITIZE_FULL_SPECIAL_CHARS);
 $tainted = $sanitized ;
 
$query = ""SELECT * FROM '"". $tainted . ""'"";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-indexArray__func_FILTER-CLEANING-full_special_chars_filter__select_from-concatenation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
//no_sanitizing
$query = ""SELECT * FROM student where id= $tainted "";
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__exec__no_sanitizing__select_from_where-interpretation
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
//no_sanitizing
$query = sprintf(""SELECT * FROM student where id='%s'"", $tainted);
//flaw
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); // Connection to the database (address, user, password)
mysql_select_db('dbname') ;
echo ""query : "". $query .""<br /><br />"" ;
$res = mysql_query($query); //execution
while($data =mysql_fetch_array($res)){
print_r($data) ;
echo ""<br />"" ;
} 
mysql_close($conn);
?>",1,CWE_89__object-Array__no_sanitizing__select_from_where-sprintf_%s_simple_quote
