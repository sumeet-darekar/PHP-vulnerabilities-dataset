PHP_Code,is_vulnerable,Description
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__CAST-cast_int__non_prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__whitelist_using_array__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ESAPI__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ternary_white_list__non_prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__whitelist_using_array__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ternary_white_list__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__whitelist_using_array__prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ESAPI__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__Indirect_reference__non_prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__Indirect_reference__prepared_query-no_right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ESAPI__select_from_where-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__Indirect_reference__prepared_query-no_right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ESAPI__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__Indirect_reference__non_prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ESAPI__prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ESAPI__prepared_query-no_right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__whitelist_using_array__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__whitelist_using_array__non_prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__CAST-cast_int__prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ESAPI__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__whitelist_using_array__prepared_query-no_right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ESAPI__prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__Indirect_reference__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ESAPI__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ternary_white_list__prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__CAST-cast_int__prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ternary_white_list__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__whitelist_using_array__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__CAST-cast_int__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ESAPI__non_prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = $_SESSION['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ESAPI__prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ESAPI__prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ternary_white_list__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__Indirect_reference__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__Indirect_reference__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__whitelist_using_array__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__whitelist_using_array__prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ternary_white_list__prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ESAPI__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ESAPI__prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ESAPI__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__whitelist_using_array__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__whitelist_using_array__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ESAPI__prepared_query-no_right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ESAPI__prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__CAST-cast_int__prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ternary_white_list__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ternary_white_list__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ESAPI__prepared_query-no_right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__Indirect_reference__prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ESAPI__non_prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__Indirect_reference__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__Indirect_reference__prepared_query-no_right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__Indirect_reference__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ternary_white_list__prepared_query-no_right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ESAPI__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ESAPI__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__Indirect_reference__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ESAPI__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__whitelist_using_array__prepared_query-no_right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__Indirect_reference__non_prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__Indirect_reference__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__Indirect_reference__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ESAPI__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__whitelist_using_array__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ternary_white_list__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__whitelist_using_array__prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ternary_white_list__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ternary_white_list__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_SESSION['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__Indirect_reference__prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__Indirect_reference__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__CAST-cast_int__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__whitelist_using_array__prepared_query-no_right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ESAPI__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ternary_white_list__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ESAPI__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__whitelist_using_array__prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__Indirect_reference__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__CAST-cast_int__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__Indirect_reference__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__Indirect_reference__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__Indirect_reference__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__whitelist_using_array__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__CAST-cast_int__prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = system('ls', $retval);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__whitelist_using_array__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ternary_white_list__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ternary_white_list__prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__whitelist_using_array__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__CAST-cast_int__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ESAPI__prepared_query-no_right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ESAPI__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__whitelist_using_array__prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__whitelist_using_array__prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ternary_white_list__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__Indirect_reference__prepared_query-no_right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__whitelist_using_array__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ternary_white_list__non_prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__whitelist_using_array__prepared_query-no_right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ESAPI__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_SESSION['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__CAST-cast_int__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ternary_white_list__prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__whitelist_using_array__prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ternary_white_list__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__Indirect_reference__prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ternary_white_list__prepared_query-no_right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__Indirect_reference__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ESAPI__select_from_where-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ESAPI__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__CAST-cast_int__prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ternary_white_list__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__ternary_white_list__prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__Indirect_reference__prepared_query-no_right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = $_GET['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__whitelist_using_array__non_prepared_query-right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ternary_white_list__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ESAPI__prepared_query-no_right_verification
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__Indirect_reference__prepared_query-no_right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__whitelist_using_array__prepared_query-no_right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__ternary_white_list__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__whitelist_using_array__prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ternary_white_list__prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__whitelist_using_array__prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ternary_white_list__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__Indirect_reference__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ESAPI__non_prepared_query-right_verification
"<?php
$array = array();
$array[] = 'safe' ;
$array[] = $_GET['userData'] ;
$array[] = 'safe' ;
$tainted = $array[1] ;
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__array-GET__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__whitelist_using_array__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__CAST-cast_int__non_prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ESAPI__prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__ternary_white_list__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ESAPI__prepared_query-no_right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__Indirect_reference__prepared_query-no_right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__ternary_white_list__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_GET['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$tainted = system('ls', $retval);
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__CAST-cast_int__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__ESAPI__non_prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ternary_white_list__prepared_query-right_verification
"<?php
$string = $_POST['UserData'] ;
$tainted = unserialize($string);
 
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__unserialize__Indirect_reference__prepared_query-right_verification
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__Indirect_reference__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ESAPI__prepared_query-no_right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__whitelist_using_array__non_prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__CAST-cast_int__prepared_query-right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ESAPI__prepared_query-no_right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ESAPI__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ternary_white_list__prepared_query-no_right_verification
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__Indirect_reference__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__ESAPI__prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__ESAPI__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__CAST-cast_int__non_prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = $_POST['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__whitelist_using_array__non_prepared_query-right_verification
"<?php
class Input{
 public function getInput(){
 return $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-directGet__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$handle = @fopen(""/tmp/tainted.txt"", ""r"");
if ($handle) {
 if(($tainted = fgets($handle, 4096)) == false) {
 $tainted = """";
 }
 fclose($handle);
} else {
 $tainted = """";
}
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__fopen__ternary_white_list__prepared_query-no_right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ESAPI__prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__CAST-cast_int__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = $_POST['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__Indirect_reference__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__Indirect_reference__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__CAST-cast_int__prepared_query-right_verification
"<?php
$tainted = shell_exec('cat /tmp/tainted.txt');
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__shell_exec__ternary_white_list__prepared_query-right_verification
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input[1];
 }
 public function __construct(){
 $this->input = array();
 $this->input[0]= 'safe' ;
 $this->input[1]= $_GET['UserData'] ;
 $this->input[2]= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-Array__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$handle = popen('/bin/cat /tmp/tainted.txt', 'r');
$tainted = fread($handle, 4096);
pclose($handle);
$tainted = (int) $tainted ;
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__popen__CAST-cast_int__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ESAPI__select_from_where-interpretation_simple_quote
"<?php
$tainted = `cat /tmp/tainted.txt`;
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__whitelist_using_array__prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__Indirect_reference__prepared_query-right_verification
"<?php
$tainted = system('ls', $retval);
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE WHERE id=?"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__system__Indirect_reference__prepared_query-no_right_verification
"<?php
$tainted = $_SESSION['UserData'];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
$tainted = $_POST['UserData'];
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__POST__Indirect_reference__select_from_where-interpretation_simple_quote
"<?php
$script = ""/tmp/tainted.php"";
exec($script, $result, $return);
$tainted = $result[0];
$tainted = $tainted == 'safe1' ? 'safe1' : 'safe2';
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__exec__ternary_white_list__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input;
 }
 public function __construct(){
 $this->input = $_GET['UserData'] ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-classicGet__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$course_array = array();
//get the user id
$user_id = intval($_SESSION[‘user_id’]);
//creation of the references with only data allowed to the user
$result = mysql_query(""SELECT * FROM COURSE where course.allowed = {$user_id}"");
while ($row = mysql_fetch_array($result)){
 $course_array[] = $result[‘id’];
}
$_SESSION[‘course_array’] = $course_array;
if (isset($_SESSION[‘course_array’])){
 $course_array = $_SESSION[‘course_array’];
 if (isset($course_array[$taintedId])){
 //indirect reference > get the right id
 $tainted = $course_array[$tainted];
 }
}
else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__Indirect_reference__non_prepared_query-right_verification
"<?php
$tainted = `cat /tmp/tainted.txt`;
$ESAPI = new ESAPI();
ESAPI::setEncoder(new DefaultEncoder());
ESAPI::setValidator(new DefaultValidator());
//verifying the data with ESAPI
if($ESAPI->validator->isValidNumber(""Course ID"", $tainted, 18, 25, false)) {
 $tainted = $tainted;
} else {
 $tainted = 0; //default value
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__backticks__ESAPI__non_prepared_query-right_verification
"<?php
$tainted = $_SESSION['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__SESSION__whitelist_using_array__non_prepared_query-right_verification
"<?php
$tainted = $_GET['UserData'];
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM student where id=' $tainted '"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__GET__whitelist_using_array__select_from_where-interpretation_simple_quote
"<?php
class Input{
 private $input;
 public function getInput(){
 return $this->input['realOne'];
 }
 public function __construct(){
 $this->input = array();
 $this->input['test']= 'safe' ;
 $this->input['realOne']= $_GET['UserData'] ;
 $this->input['trap']= 'safe' ;
 }
}
$temp = new Input();
$tainted = $temp->getInput();
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID='$tainted'"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__object-indexArray__whitelist_using_array__non_prepared_query-right_verification
"<?php
$descriptorspec = array(
 0 => array(""pipe"", ""r""),
 1 => array(""pipe"", ""w""),
 2 => array(""file"", ""/tmp/error-output.txt"", ""a"")
 );
$cwd = '/tmp';
$process = proc_open('more /tmp/tainted.txt', $descriptorspec, $pipes, $cwd, NULL);
if (is_resource($process)) {
 fclose($pipes[0]);
 $tainted = stream_get_contents($pipes[1]);
 fclose($pipes[1]);
 $return_value = proc_close($process);
}
$legal_table = array(""safe1"", ""safe2"");
if (in_array($tainted, $legal_table, true)) {
 $tainted = $tainted;
} else {
 $tainted = $legal_table[0];
}
$query = ""SELECT * FROM COURSE, USER WHERE courseID=?"";
$query .= ""AND course.allowed=$_SESSION[userid]"";
$conn = mysql_connect('localhost', 'mysql_user', 'mysql_password'); //Connection to the database (address, user, password)
$stmt = $conn->prepare($query);
$stmt->bind_param(""i"", $checked_data);
$stmt->execute();
mysql_close($conn);
 ?>",0,CWE_862_SQL__proc_open__whitelist_using_array__prepared_query-right_verification
